<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <title>Patient list</title>
</head>
<body>
<div class="background"
     style="background-image: url('https://media.hswstatic.com/eyJidWNrZXQiOiJjb250ZW50Lmhzd3N0YXRpYy5jb20iLCJrZXkiOiJnaWZcL2JlY29taW5nLWRvY3Rvci5qcGciLCJlZGl0cyI6eyJyZXNpemUiOnsid2lkdGgiOjgyOH19fQ==');  background-size: cover; background-position: center center; height: 100vh; width: 100%;">
    <h2> Patients list</h2>

    <!--<table border="1" class="table table-striped">-->

    <table class="table table-striped-columns">
        <thead>
        <tr>
            <th> Id</th>
            <th> Name</th>
            <th> Actions</th>

        </tr>
        </thead>
        <tbody>
        <tr th:if="${patients.empty}">
            <td colspan="2"> No patients registered</td>
        </tr>
        <tr th:each="patient : ${patients}">
            <td><span th:text="${patient.id}"> Id </span></td>
            <td><span th:text="${patient.name}"> Name </span></td>

            <td><button class="btn btn-primary add-medication-button"
                    onclick="window.location.href='/medication/create/1';">
                Add medication
            </button></td>


        </tr>
        </tbody>
    </table>

    <p></p>

    <button onclick="window.location.href='/dashboard';">
        Main menu
    </button>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
            crossorigin="anonymous"></script>
</body>
</html>

<script>
        const addButtons = document.querySelectorAll('.add-medication-button');
        addButtons.forEach(function (addButton) {
            addButton.addEventListener("click", function () {
                    const patientId = this.parentNode.parentNode.querySelector(".patientId").textContent;
                    console.log (this.parentNode.parentNode);
                    fetch('/create/{patientId}/' + patientId, {
                        method: 'GET'
                    }).then(function (response) {
                        if (response.ok) {
                        } else {
                        }
                    });
                }
            });
        });
    </script>